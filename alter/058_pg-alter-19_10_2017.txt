﻿CREATE OR REPLACE FUNCTION INSERT_PREFERENCE(_NAME TEXT, _VALUE TEXT)
RETURNS VOID AS
$$
DECLARE USERS TEXT[];
DECLARE i INTEGER;
BEGIN
USERS := ARRAY(SELECT DISTINCT user_id FROM zafira.user_preferences);
FOREACH i IN ARRAY USERS
LOOP
INSERT INTO zafira.USER_PREFERENCES (NAME, VALUE, USER_ID) VALUES
	(_NAME, _VALUE, i);
END LOOP;
END $$
LANGUAGE plpgsql;

SELECT INSERT_PREFERENCE('THEME', '32');